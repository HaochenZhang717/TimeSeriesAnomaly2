Train Epoch 0:   0%|                                                                                           | 0/489 [00:00<?, ?it/s]
> /Users/zhc/Documents/PhD/projects/TimeSeriesAnomaly/code/Trainers/DSPFlow_trainer/trainer.py(60)no_context_train()
-> loss = self.model(batch, mode="no_context")
*** KeyError: 'signal'
torch.Size([64, 800, 1])
tensor([[0.3581],
        [0.3528],
        [0.3560],
        [0.3646],
        [0.3657],
        [0.3657],
        [0.3603],
        [0.3603],
        [0.3581],
        [0.3592],
        [0.3668],
        [0.3646],
        [0.3635],
        [0.3571],
        [0.3452],
        [0.3517],
        [0.3635],
        [0.3711],
        [0.3722],
        [0.3635],
        [0.3549],
        [0.3538],
        [0.3549],
        [0.3581],
        [0.3592],
        [0.3625],
        [0.3700],
        [0.3776],
        [0.3873],
        [0.3905],
        [0.3916],
        [0.3883],
        [0.3894],
        [0.3916],
        [0.3927],
        [0.3959],
        [0.3970],
        [0.3981],
        [0.4002],
        [0.4067],
        [0.4067],
        [0.4067],
        [0.4002],
        [0.3991],
        [0.4035],
        [0.4132],
        [0.4250],
        [0.4358],
        [0.4358],
        [0.4315],
        [0.4337],
        [0.4412],
        [0.4498],
        [0.4563],
        [0.4563],
        [0.4585],
        [0.4617],
        [0.4639],
        [0.4736],
        [0.4822],
        [0.4876],
        [0.4898],
        [0.4919],
        [0.4984],
        [0.5081],
        [0.5124],
        [0.5167],
        [0.5178],
        [0.5146],
        [0.5156],
        [0.5221],
        [0.5254],
        [0.5221],
        [0.5156],
        [0.5178],
        [0.5210],
        [0.5264],
        [0.5232],
        [0.5210],
        [0.5156],
        [0.5092],
        [0.5070],
        [0.5038],
        [0.4984],
        [0.4854],
        [0.4757],
        [0.4757],
        [0.4790],
        [0.4779],
        [0.4693],
        [0.4585],
        [0.4509],
        [0.4455],
        [0.4455],
        [0.4434],
        [0.4423],
        [0.4369],
        [0.4337],
        [0.4239],
        [0.4186],
        [0.4175],
        [0.4153],
        [0.4121],
        [0.4110],
        [0.4088],
        [0.4067],
        [0.4045],
        [0.4013],
        [0.4002],
        [0.3959],
        [0.3905],
        [0.3873],
        [0.3937],
        [0.3970],
        [0.3991],
        [0.3927],
        [0.3862],
        [0.3819],
        [0.3916],
        [0.3894],
        [0.3916],
        [0.3883],
        [0.3883],
        [0.3873],
        [0.3883],
        [0.3916],
        [0.3905],
        [0.3894],
        [0.3851],
        [0.3873],
        [0.3927],
        [0.3916],
        [0.3873],
        [0.3830],
        [0.3862],
        [0.3916],
        [0.3959],
        [0.4002],
        [0.4002],
        [0.3991],
        [0.4002],
        [0.3991],
        [0.4002],
        [0.4013],
        [0.4013],
        [0.3981],
        [0.3970],
        [0.4002],
        [0.4002],
        [0.4013],
        [0.4013],
        [0.3981],
        [0.3991],
        [0.4013],
        [0.4024],
        [0.4024],
        [0.4013],
        [0.3991],
        [0.4035],
        [0.3991],
        [0.4035],
        [0.4067],
        [0.4013],
        [0.3948],
        [0.3927],
        [0.3970],
        [0.4045],
        [0.4121],
        [0.4099],
        [0.4035],
        [0.3970],
        [0.3959],
        [0.3948],
        [0.4013],
        [0.4035],
        [0.4035],
        [0.4013],
        [0.3981],
        [0.3981],
        [0.3970],
        [0.3937],
        [0.3916],
        [0.3883],
        [0.3927],
        [0.3937],
        [0.3970],
        [0.3905],
        [0.3916],
        [0.3851],
        [0.3830],
        [0.3894],
        [0.3883],
        [0.3894],
        [0.3819],
        [0.3786],
        [0.3808],
        [0.3808],
        [0.3808],
        [0.3862],
        [0.3894],
        [0.3894],
        [0.3894],
        [0.3937],
        [0.3948],
        [0.3927],
        [0.3894],
        [0.3862],
        [0.3862],
        [0.3840],
        [0.3830],
        [0.3819],
        [0.3840],
        [0.3862],
        [0.3862],
        [0.3883],
        [0.3851],
        [0.3830],
        [0.3765],
        [0.3732],
        [0.3711],
        [0.3754],
        [0.3830],
        [0.3840],
        [0.3862],
        [0.3840],
        [0.3840],
        [0.3894],
        [0.3862],
        [0.3862],
        [0.3840],
        [0.3840],
        [0.3840],
        [0.3851],
        [0.3819],
        [0.3808],
        [0.3743],
        [0.3743],
        [0.3765],
        [0.3830],
        [0.3873],
        [0.3873],
        [0.3862],
        [0.3797],
        [0.3808],
        [0.3808],
        [0.3873],
        [0.3851],
        [0.3819],
        [0.3786],
        [0.3851],
        [0.3840],
        [0.3830],
        [0.3808],
        [0.3776],
        [0.3776],
        [0.3776],
        [0.3819],
        [0.3808],
        [0.3797],
        [0.3754],
        [0.3765],
        [0.3765],
        [0.3797],
        [0.3819],
        [0.3797],
        [0.3797],
        [0.3830],
        [0.3862],
        [0.3873],
        [0.3873],
        [0.3830],
        [0.3819],
        [0.3851],
        [0.3883],
        [0.3916],
        [0.3948],
        [0.4002],
        [0.4013],
        [0.3991],
        [0.4045],
        [0.4088],
        [0.4207],
        [0.4293],
        [0.4293],
        [0.4304],
        [0.4337],
        [0.4358],
        [0.4337],
        [0.4283],
        [0.4196],
        [0.4186],
        [0.4175],
        [0.4142],
        [0.4110],
        [0.4056],
        [0.3927],
        [0.3873],
        [0.3862],
        [0.3937],
        [0.3991],
        [0.3981],
        [0.3905],
        [0.3808],
        [0.3862],
        [0.3916],
        [0.3970],
        [0.3948],
        [0.3948],
        [0.3927],
        [0.3937],
        [0.3959],
        [0.3948],
        [0.3916],
        [0.3873],
        [0.3840],
        [0.3819],
        [0.3840],
        [0.3959],
        [0.4164],
        [0.4552],
        [0.5146],
        [0.5836],
        [0.6505],
        [0.7023],
        [0.7335],
        [0.7454],
        [0.7476],
        [0.7389],
        [0.7152],
        [0.6645],
        [0.5912],
        [0.4951],
        [0.4207],
        [0.3883],
        [0.3937],
        [0.4002],
        [0.3937],
        [0.3894],
        [0.3808],
        [0.3765],
        [0.3776],
        [0.3797],
        [0.3776],
        [0.3732],
        [0.3679],
        [0.3603],
        [0.3581],
        [0.3581],
        [0.3614],
        [0.3603],
        [0.3581],
        [0.3592],
        [0.3592],
        [0.3614],
        [0.3592],
        [0.3581],
        [0.3571],
        [0.3571],
        [0.3603],
        [0.3625],
        [0.3571],
        [0.3528],
        [0.3528],
        [0.3495],
        [0.3474],
        [0.3538],
        [0.3571],
        [0.3614],
        [0.3581],
        [0.3571],
        [0.3614],
        [0.3679],
        [0.3668],
        [0.3646],
        [0.3635],
        [0.3614],
        [0.3668],
        [0.3679],
        [0.3668],
        [0.3668],
        [0.3657],
        [0.3700],
        [0.3700],
        [0.3711],
        [0.3722],
        [0.3743],
        [0.3722],
        [0.3765],
        [0.3776],
        [0.3786],
        [0.3797],
        [0.3776],
        [0.3765],
        [0.3840],
        [0.3873],
        [0.3937],
        [0.3948],
        [0.3916],
        [0.3873],
        [0.3905],
        [0.3991],
        [0.4056],
        [0.4078],
        [0.4067],
        [0.4078],
        [0.4110],
        [0.4175],
        [0.4186],
        [0.4196],
        [0.4218],
        [0.4272],
        [0.4358],
        [0.4401],
        [0.4444],
        [0.4455],
        [0.4498],
        [0.4574],
        [0.4671],
        [0.4746],
        [0.4800],
        [0.4822],
        [0.4790],
        [0.4811],
        [0.4854],
        [0.4951],
        [0.5092],
        [0.5146],
        [0.5167],
        [0.5189],
        [0.5178],
        [0.5189],
        [0.5232],
        [0.5232],
        [0.5221],
        [0.5200],
        [0.5189],
        [0.5178],
        [0.5178],
        [0.5135],
        [0.5027],
        [0.5016],
        [0.4973],
        [0.4951],
        [0.4908],
        [0.4908],
        [0.4822],
        [0.4703],
        [0.4660],
        [0.4649],
        [0.4606],
        [0.4552],
        [0.4477],
        [0.4412],
        [0.4315],
        [0.4293],
        [0.4261],
        [0.4272],
        [0.4229],
        [0.4218],
        [0.4175],
        [0.4142],
        [0.4142],
        [0.4067],
        [0.4013],
        [0.4013],
        [0.3970],
        [0.3948],
        [0.3927],
        [0.3894],
        [0.3840],
        [0.3840],
        [0.3819],
        [0.3808],
        [0.3808],
        [0.3765],
        [0.3679],
        [0.3689],
        [0.3689],
        [0.3668],
        [0.3668],
        [0.3625],
        [0.3581],
        [0.3560],
        [0.3592],
        [0.3646],
        [0.3668],
        [0.3657],
        [0.3614],
        [0.3581],
        [0.3603],
        [0.3646],
        [0.3668],
        [0.3635],
        [0.3614],
        [0.3581],
        [0.3603],
        [0.3603],
        [0.3592],
        [0.3592],
        [0.3581],
        [0.3581],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000],
        [0.0000]])
tensor([[True, True, True,  ..., True, True, True],
        [True, True, True,  ..., True, True, True],
        [True, True, True,  ..., True, True, True],
        ...,
        [True, True, True,  ..., True, True, True],
        [True, True, True,  ..., True, True, True],
        [True, True, True,  ..., True, True, True]])
torch.Size([800])
tensor([True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True, True, True, True, True,
        True, True, True, True, True, True, True, True])
Traceback (most recent call last):
  File "/Users/zhc/Documents/PhD/projects/TimeSeriesAnomaly/code/dsp_flow.py", line 255, in <module>
    main()
  File "/Users/zhc/Documents/PhD/projects/TimeSeriesAnomaly/code/dsp_flow.py", line 233, in main
    no_context_pretrain(args)
  File "/Users/zhc/Documents/PhD/projects/TimeSeriesAnomaly/code/dsp_flow.py", line 219, in no_context_pretrain
    trainer.no_context_train(config=vars(args))
  File "/Users/zhc/Documents/PhD/projects/TimeSeriesAnomaly/code/Trainers/DSPFlow_trainer/trainer.py", line 60, in no_context_train
    loss = self.model(batch, mode="no_context")
           ^^^^
  File "/opt/anaconda3/envs/ColOCR_env/lib/python3.12/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ColOCR_env/lib/python3.12/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit
